"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4156],{48562:function(e,t,i){var n=i(11527),a=i(50959);let l=e=>{let{data:t,className:i="",source:a="",isSingle:l=!1}=e;return(0,n.jsxs)("a",{href:"product"===a?null==t?void 0:t.product_url:a?"".concat(t.url,"/").concat(a):t.url,className:"".concat(l?"":"m-1"," badge-tag ").concat(t.isGray?"badge-gray-tag":""," ").concat(i),children:[(null==t?void 0:t.icon_url)&&(0,n.jsx)("img",{src:t.icon_url,alt:"",width:"16",height:"16",className:"me-1"}),t.name]},t.id)};t.Z=a.memo(l)},57439:function(e,t,i){var n=i(11527),a=i(50959),l=i(80850),r=i(79253),c=i(40520),s=i(5907),o=i(46543),d=i(23878),u=i(90484);let m=e=>{let{id:t,type:i,actions:s=[],member_actions:m=[],onCallBack:h,sessionUser:v,className:g,qid:p,questionDetail:f,tagName:b}=e,[x,k]=(0,a.useState)({visable:!1,action:"",actionName:""}),{site:y={},question:{is_site:w=1}={}}="question"===i&&f[t]||{},[I,j]=(0,a.useState)(!1),[N,E]=(0,a.useState)(!1),[F,S]=(0,a.useState)(!1),A=e=>{(0,u.dFf)({id:t,type:i,handle:e}).then(e=>{h(e)})},C=async e=>{if("report"===x.action){let i;let n=await (0,u.Hjr)({object_id:t,...e}).catch(e=>{i=null==e?void 0:e.object_id});h(n||i,x.action);return}if("seo"===x.action||"hide-setting"===x.action){h("",x.action);return}if("delete"===x.action){(0,u.qF1)({id:t,type:i,...e}).then(e=>{h(e,x.action)});return}(0,u.dFf)({id:t,type:i,handle:x.action,...e}).then(e=>{h(e,x.action)})},Z=()=>{d.ZP.confirm({title:"社区维基",content:'转为<a href="'.concat(c.n5,'" target="_blank"> 社区维基 </a>后，该内容署名将捐献给社区，且后续投票不再影响你的声望，确定继续？'),onSuccess:()=>{A("wiki")}})},q=()=>{let e="";switch(i){case"article":e="/a/".concat(t,"/edit");break;case"question":e="/q/".concat(t,"/edit");break;case"answer":e="/q/".concat(p,"/a-").concat(t,"/edit");break;case"product":e="/product/".concat(t,"/edit");break;case"product-score":e="/product/".concat(p,"/r-").concat(t,"/edit");break;case"tag":e="/t/".concat(encodeURIComponent(b),"/edit");break;case"event":e="/events/".concat(t,"/edit")}return e},L=m.filter(e=>"edit"===e.type),T=m.filter(e=>"edit"!==e.type);return(0,n.jsxs)("div",{className:g,children:[(m.length>0||s.length>0)&&(0,n.jsxs)(n.Fragment,{children:[L.map(e=>{let t=q();return(0,n.jsx)(l.Z,{variant:"link",className:"text-secondary btn-reset ".concat(i,"-edit"),href:t,children:"编辑"},e.name)}),L.length>0&&(T.length>0||(null==s?void 0:s.length)>0)&&(0,n.jsx)("span",{className:"split-dot"}),(T.length>0||(null==s?void 0:s.length)>0)&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(r.Z,{className:"d-inline-block",children:[(0,n.jsx)(r.Z.Toggle,{as:o.Z,className:"text-secondary",children:"操作"}),(0,n.jsxs)(r.Z.Menu,{children:[T.map((e,t)=>"reason"===e.type?(0,n.jsx)(r.Z.Item,{as:"button",onClick:()=>{k({action:e.action,visable:!0,actionName:e.name})},children:e.name},e.name+t):"wiki"===e.action?(0,n.jsx)(r.Z.Item,{as:"button",onClick:()=>Z(),children:e.name},e.name+t):"put"===e.type?(0,n.jsx)(r.Z.Item,{as:"button",onClick:()=>A(e.action),children:e.name},e.name+t):void 0),s.length>0&&T.length>0&&(0,n.jsx)(r.Z.Divider,{}),s.map((e,a)=>{if("edit"===e.type){let l;switch(i){case"article":l="/a/".concat(t,"/edit");break;case"question":l="/q/".concat(t,"/edit");break;case"answer":l="/q/".concat(p,"/a-").concat(t,"/edit");break;case"product":l="/product/".concat(t,"/edit");break;case"product-score":l="/product/".concat(p,"/r-").concat(t,"/edit")}return(0,n.jsx)(r.Z.Item,{href:l,children:e.name},e.name+a)}return"reason"===e.type?(0,n.jsx)(r.Z.Item,{onClick:()=>{k({action:e.action,visable:!0,actionName:e.name})},children:e.name},e.name+a):"put"===e.type?(0,n.jsx)(r.Z.Item,{onClick:()=>A(e.action),children:e.name},e.name+a):"site"===e.type?(0,n.jsx)(r.Z.Item,{onClick:()=>{j(!0),k({...x,action:e.action})},children:e.name},e.name+a):"seo"===e.type?(0,n.jsx)(r.Z.Item,{onClick:()=>{E(!0),k({...x,action:e.action})},children:e.name},e.name+a):"hide"===e.type?(0,n.jsx)(r.Z.Item,{onClick:()=>{S(!0),k({...x,action:e.action})},children:e.name},e.name+a):(0,n.jsx)(r.Z.Item,{children:e.name},e.name+a)})]})]})})]}),(m.length>0||(null==s?void 0:s.length)>0)&&(0,n.jsx)("span",{className:"split-dot"}),v&&(0,n.jsx)(l.Z,{variant:"link",className:"text-secondary btn-reset",onClick:e=>{e.preventDefault(),k({action:"report",visable:!0,actionName:"举报"})},children:"举报"}),x.visable&&(0,n.jsx)(d.rK,{id:t,isShow:!0,action:x.action,actionName:x.actionName,setModalStatus:k,onOk:C}),I&&(0,n.jsx)(d.B3,{isShow:!0,setModalStatus:j,callback:C,siteId:null==y?void 0:y.id,isSite:w}),(0,n.jsx)(d.uP,{id:t,isShow:N,setModalStatus:E,callBack:C}),(0,n.jsx)(d.h8,{id:t,isShow:F,setModalStatus:S,callBack:C})]})};t.Z=(0,s.$j)(e=>{let{global:t,question:i}=e;return{sessionUser:t.sessionUser,questionDetail:null==i?void 0:i.questionDetail}})(a.memo(m))},21438:function(e,t,i){i.d(t,{zG:function(){return r}});var n=i(50959),a=i(5907);class l{run(e){this.wrap=e,this.allImgs=e.querySelectorAll("article img"),this.bindImgClick(),this.bindEvent()}createViewer(){var e;if(!(0,a.jU)()||this.viewFrame)return;this.viewFrame=document.createElement("div"),this.viewFrame.className="is-active ImageView p-4",this.viewFrame.style.display="none",this.viewFrame.innerHTML='<div class="ImageView-inner" style="overflow: auto;">\n      <img src="" class="ImageView-img" referrerpolicy="no-referrer" alt="preview" style="max-width: 100%; max-height: 100%;">\n    </div>';let t=document.body||document.documentElement;t.appendChild(this.viewFrame),null===(e=this.viewFrame)||void 0===e||e.addEventListener("click",()=>{this.viewFrame&&(this.viewFrame.style.display="none",this.viewFrame.classList.remove("fadeIn"),this.viewFrame.classList.add("fadeOut"))})}bindEvent(){this.allImgs.forEach(e=>{let t=e.getAttribute("src")||e.getAttribute("data-src")||"";(null==t?void 0:t.startsWith("/img/"))&&!(null==t?void 0:t.match(/\/view$/))&&(t.indexOf("?")>-1?t=t.substring(0,t.indexOf("?"))+"/view"+t.substring(t.indexOf("?")):t+="/view"),t&&this.imgArr.push(t)});let e=document.body||document.documentElement;e.addEventListener("keydown",e=>{var t,i,n,a,l,r;(null===(t=this.viewFrame)||void 0===t?void 0:t.style.display)!=="none"&&(37===e.keyCode&&this.curIndex>0&&(this.curIndex=this.curIndex-1,null===(n=null===(a=this.viewFrame)||void 0===a?void 0:a.querySelector("img"))||void 0===n||n.setAttribute("src",this.imgArr[this.curIndex])),39===e.keyCode&&this.curIndex<(null===(i=this.imgArr)||void 0===i?void 0:i.length)-1&&(this.curIndex=this.curIndex+1,null===(l=null===(r=this.viewFrame)||void 0===r?void 0:r.querySelector("img"))||void 0===l||l.setAttribute("src",this.imgArr[this.curIndex])))})}bindImgClick(){this.allImgs.forEach((e,t)=>{e.addEventListener("click",()=>{let i=(null==e?void 0:e.getAttribute("src"))||(null==e?void 0:e.getAttribute("data-src"));this.curIndex=t;let n=null==e?void 0:e.parentElement,a=0;for(let e=0;e<5;e++){if((null==n?void 0:n.tagName)==="A"){a+=1;break}n=null==n?void 0:n.parentElement}if(!(a>0)&&(null==i?void 0:i.startsWith("/img/"))&&!(null==i?void 0:i.match(/\/view$/))){var l;i.indexOf("?")>-1?i=i.substring(0,i.indexOf("?"))+"/view"+i.substring(i.indexOf("?")):i+="/view";let e=null===(l=this.viewFrame)||void 0===l?void 0:l.querySelector("img");e&&(e.setAttribute("src",i),e.addEventListener("load",()=>{this.viewFrame&&(this.viewFrame.style.display="block",this.viewFrame.classList.remove("fadeOut"),this.viewFrame.classList.add("fadeIn"))}))}})})}constructor(){this.curIndex=1,this.imgArr=[],this.createViewer()}}let r=e=>{let[t,i]=(0,n.useState)();return(0,n.useEffect)(()=>{e&&!t&&e.match(/<img/)&&i(new l)},[e,t]),t},c=new l;t.ZP=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;c.run(e)}},16857:function(e,t,i){i.d(t,{k:function(){return n}});class n{buildNavTitle(){let e,t;for(t=1;t<=3;t++)if(this.$article.querySelectorAll("h"+t).length){e=3===t?this.$article.querySelectorAll("h"+t):this.$article.querySelectorAll("h".concat(t,", h").concat(t+1));break}let i=0,n=0;(null==e?void 0:e.length)&&e.forEach(e=>{let a=e.nodeName.substr(1,1);if(Number(a)===t){i++,e.setAttribute("id","item-".concat(i));let t=document.createElement("a");t.className="list-group-item border-0 link-secondary text-truncate-1 px-0",t.setAttribute("href","#item-".concat(i)),t.innerText=e.textContent.replace(/</gi,"&lt;").replace(/>/gi,"&gt;"),this.$parent.appendChild(t)}else{n++,e.setAttribute("id","item-".concat(i,"-").concat(n));let t=document.createElement("a");t.className="list-group-item border-0 link-secondary text-truncate-1 ps-3",t.setAttribute("href","#item-".concat(i,"-").concat(n)),t.innerText=e.textContent.replace(/</gi,"&lt;").replace(/>/gi,"&gt;"),this.$parent.appendChild(t)}});let a=[],l=[],r=[];null==e||e.forEach(e=>{switch(e.tagName){case"H1":a.push(e.tagName);break;case"H2":l.push(e.tagName);break;case"H3":r.push(e.tagName)}});let c=!1;return a.length>=2?c=!0:0===a.length&&l.length>=2?c=!0:0===a.length&&0===l.length&&r.length>=2&&(c=!0),!!e&&!!c&&!!e}init(){if(!this.$parent)return;let e=this.buildNavTitle(),t=document.querySelector("#collapseTarget");if(e)t&&t.classList.remove("d-none"),this.callback instanceof Function&&this.callback();else{var i;null==t||null===(i=t.parentNode)||void 0===i||i.removeChild(t);return}let n=document.querySelectorAll("#collapseTarget a");n.forEach(e=>{e.addEventListener("click",e=>{n.forEach(t=>{var i,n;t.classList.add("link-secondary"),t.classList.remove("text-primary");let a=e.currentTarget;null==a||null===(i=a.classList)||void 0===i||i.remove("link-secondary"),null==a||null===(n=a.classList)||void 0===n||n.add("text-primary")})})})}constructor(e,t,i){this.$parent=e,this.$article=t,this.callback=i,this.init()}}},38640:function(e,t,i){i.d(t,{Z:function(){return n}});function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!(null==e?void 0:e.length))return;let i=e.map(e=>{var t;return null===(t=null==document?void 0:document.getElementById(e.substr(1)))||void 0===t?void 0:t.getBoundingClientRect()}),n=i.map((n,a)=>{var l;return{index:a,id:e[a],top:n.top-t,contentHeight:(null===(l=i[a+1])||void 0===l?void 0:l.top)-n.top}}),a=n.reduce((e,t)=>Math.abs(t.top)<Math.abs(e.top)&&e.top+e.contentHeight<24?t:e),l=document.querySelectorAll("#article-nav-list a");for(let e=0;e<l.length;e++){let t=l[e],i=t.getAttribute("href");i===a.id?(t.classList.remove("link-secondary"),t.classList.add("text-primary")):(t.classList.remove("text-primary"),t.classList.add("link-secondary"))}let r=document.getElementById("collapseTarget"),c=l[a.index];if(!r||!c)return;let s=r.getBoundingClientRect();c.offsetTop<s.top&&r.scrollTo({top:c.offsetTop-24}),c.offsetTop+c.offsetHeight>s.top+s.height&&r.scrollTo({top:c.offsetTop+c.offsetHeight-s.height+24})}}}]);