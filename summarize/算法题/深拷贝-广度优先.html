<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>深度拷贝</title>
</head>
<body>
<script>
    /* 
    */
    function isObject(d) {
        return typeof d === 'object' && d !== null;
    }
    function isArray(d) {
        return Array.isArray(d);
    }

    function deepClone(source, weakMap) {
        if (!isObject(source)) {
            return source;
        }
        weakMap = weakMap || new WeakMap(); // 存放已经拷贝过的object对象 
        if (weakMap.has(source)) {
            return weakMap.get(source)
        }
        let target = null;
        let queen = [
            {
                parent: target,
                data: source
            }
        ];
        while (queen.length) {
            let {parent, data} = queen.pop();
            Reflect.ownKeys(data).forEach(key => {
                if (!isObject(data[key])) {
                    parent[key] = data[key];
                } else {
                    isArray()
                }
            });
        }
    }

    let testSource = {
        a: 1,
        b: 2,
        c: {
            c1: 3,
            c2: 4,
            c3: /abc/,
            c4: [
                function a() {},
                new Promise(function(){}),
                new Number(1),
                RegExp,
                new RegExp('efg', 'img'),
                new Date(),
                {
                    e: [1, 2, [3]]
                }
            ]
        },
        d: obj1,
        e: arr1,
        [symbolA]: 7,
        f: symbolB,
        g: zhangsan,
        h: null,
        i: undefined,
        j: map,
        k: set
    };
    let res = deepClone(testSource);
    console.log(res);
</script>
</body>
</html>